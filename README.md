# Table of Contents

1. [Understanding the challenge](#understanding-the-challenge)
2. [Introduction](#introduction)
3. [Details](#details)
    - [Databases](#databases)
    - [Flask Application](#flask-application)
    - [Data sample](#data-sample)
4. [FAQ](#faq)




# Understanding the challenge
Some requirements may be vague on purpose or for the simple fact that we also have no idea, so we are in trial-and-error mode. When making assumption, it is advisable to explain what is considered known and under what circumstances.  
Also, you may want to try multiple assumptions.

# Introduction
In order to extract the necessary data from the electronic medical records (EMR), our Flask client application has to connect with the existing hospital information system (HIS). The type/structure/schema of the database used by the HIS may differ from vendor to vendor.  

__NOTE 0__.
Your job is to synchronize our Flask database with the data from the HIS. Schema and sample data will be provided below, but you are free to generate your own data. Should you chose to do that, we suggest the [python faker library](https://pypi.python.org/pypi/Faker/0.8.12).

__NOTE 0'__. The above is your main task, however, once you read this whole document you should assess how long it will take you to finish this assignment.

Example of assumptions:  
    * no changes can be made on the HIS side (this frequently happens, but there is still room for negotiation)  
    * very few changes can be made on the HIS side (this may be a more common situation, so you can assume more scenarios here)  
    * the HIS vendor will cooperate 100% and do whatever we tell them to do (ideal situation, it may never happen)

# Details

### Databases
1. Flask client should use PostgreSQL version 9.6.5
2. HIS database can be anything that works with SQLAlchemy version 2.2
3. This is the schema that we are trying to sync:
    - created_on: datetime (date and time when the record was created)
    - updated_on: datetime (date and time when the record was updated)
    - operation_id: string (unique string to identify the operation)
    - patient_age: integer (the age of the patient)
    - patient_gender_code: enumerated ('M' for male, 'F' for female)
    - operation_type_code: string (the type of operation)
    - operation_entry_time: datetime (operation room wheels in)
    - operation_leave_time: datetime (operation room wheels out)
    - operation_start_time: datetime (the start timestamp of the operation)
    - operation_end_time: datetime (the end timestamp of the operation)
    - operation_room_code: string (unique string to identify the ID of the operation room)
    - surgeon_code: string (unique string to identify the main surgeon)
    - surgeon_assistant_code: string (unique string to identify the assistant surgeon)
    - surgeon_anesthesiologist_code: string (unique string to identify the anesthesiologist)
    - surgeon_scrub_nurse_code: string (unique string to identify the scrub nurse)
    - surgeon_circulating_nurse_code: string (unique string to identify the circulating nurse)

__NOTE 1__.
Except the following fields, any other fields can be updated on the HIS side at any time:
*created_on, operation_id, patient_age, patient_gender_code, operation_type_code, surgeon_code*. For simplicity, assume that updates of an existing entry can occur only between `created_on` timestamp and `operation_end_time` timestamp.

### Flask application
0. Python 3 is a must.
1. You should use Flask version 0.12.2 
2. Any application server is OK, preferable gunicorn version 19.7.1
3. If you use redis (2.10.6) and/or celery (4.1.0)
4. The synchronization should be wrapped as a blueprint or extension (the reason: it should be easy to comment out the blueprint instance when not needed and not interfere with the rest of the Flask application)
5. (optional) If possible, the Flask application should run on top of Docker CE 18 or newer

### Data sample

The table below was generated by the following query:
```sql
SELECT
    created_on,
    updated_on,
    operation_id,
    patient_age,
    patient_gender_code,
    operation_type_code,
    operation_entry_time,
    operation_leave_time,
    operation_start_time,
    operation_end_time,
    operation_room_code,
    surgeon_code,
    surgeon_assistant_code,
    surgeon_anesthesiologist_code,
    surgeon_scrub_nurse_code,
    surgeon_circulating_nurse_code
FROM
    db_name
LIMIT 5;
```


| created_on                 | updated_on                 | operation_id | patient_age | patient_gender_code | operation_type_code | operation_entry_time       | operation_leave_time       | operation_start_time       | operation_end_time         | operation_room_code | surgeon_code | surgeon_assistant_code | surgeon_anesthesiologist_code | surgeon_scrub_nurse_code | surgeon_circulating_nurse_code |
|----------------------------|----------------------------|--------------|-------------|---------------------|---------------------|----------------------------|----------------------------|----------------------------|----------------------------|---------------------|--------------|------------------------|-------------------------------|--------------------------|--------------------------------|
| 2015-01-31 08:55:00.000000 | 2015-01-31 12:00:00.000000 | 15131085C    | 24          | M                   | K533                | 2015-01-31 08:55:00.000000 | 2015-01-31 12:00:00.000000 | 2015-01-31 09:51:00.000000 | 2015-01-31 11:48:00.000000 | 3                   | 570          | 8834                   | 8974                          | 1243                     | 4012                           |
| 2015-01-31 08:56:00.000000 | 2015-01-31 17:40:00.000000 | 15131065F    | 56          | M                   | K607                | 2015-01-31 08:56:00.000000 | 2015-01-31 17:40:00.000000 | 2015-01-31 10:17:00.000000 | 2015-01-31 17:17:00.000000 | 6                   | 334          | 8974                   | 601                           | 1243                     | 3781                           |
| 2015-01-31 12:48:00.000000 | 2015-01-31 13:57:00.000000 | 15131122C    | 88          | F                   | K617                | 2015-01-31 12:48:00.000000 | 2015-01-31 13:57:00.000000 | 2015-01-31 13:20:00.000000 | 2015-01-31 13:47:00.000000 | 3                   | 695          | 601                    | 91079                         | 3133                     | 4012                           |
| 2015-01-31 14:50:00.000000 | 2015-01-31 15:56:00.000000 | 15131140C    | 81          | F                   | K333-3              | 2015-01-31 14:50:00.000000 | 2015-01-31 15:56:00.000000 | 2015-01-31 15:15:00.000000 | 2015-01-31 15:44:00.000000 | 3                   | 695          |                        | 91079                         | 4122                     | 4012                           |
| 2015-01-31 20:24:00.000000 | 2015-02-01 06:16:00.000000 | 15131184F    | 71          | M                   | K867-2              | 2015-01-31 20:24:00.000000 | 2015-02-01 06:16:00.000000 | 2015-01-31 21:55:00.000000 | 2015-02-01 05:50:00.000000 | 6                   | 334          | 8834                   | 601                           | 4012                     | 3492                           |

__NOTE 2__.
The data itself (format/contents) is not as important as the sync process between the two databases.

# FAQ
1. Can I use any other libraries on top of those mentioned above?  
A: Absolutely. Just mention it in a `requirements.txt` file

2. Am I going to be penalized if I don't use comments in my code?  
A: No, but you should add some level of clarification. We may ask you to walk us through your code.

3. Should my work be original?  
A: "Good artists copy, great artists steal". We should all learn from those better than us, just don't get yourself into any legal trouble, we are not liable for that. Make sure you include your source of inspiration.

4. If I have more questions about the assignment, is it OK to ask?  
A: Absolutely, but make sure you first complete __NOTE 0'__.

















